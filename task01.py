import time      # –Ü–º–ø–æ—Ä—Ç –º–æ–¥—É–ª—è –¥–ª—è –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è —á–∞—Å—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
import random    # –Ü–º–ø–æ—Ä—Ç –º–æ–¥—É–ª—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö —Ç–∞ –∑–∞–ø–∏—Ç—ñ–≤
from typing import Optional 

#--- –ö–æ–¥ —ñ–∑ –ø–µ—Ä–µ–¥–∞—á–µ—é –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π (–ö–æ–¥, —â–æ –ø–µ—Ä–µ–¥–∞—î –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ)
# --- üß± –ë–ê–ó–û–í–ò–ô –ö–û–î: LRU-–ö–ï–® –ù–ê –û–°–ù–û–í–Ü –î–í–û–°–ü–†–Ø–ú–û–í–ê–ù–û–ì–û –°–ü–ò–°–ö–£ –¢–ê –°–õ–û–í–ù–ò–ö–ê ---

# –û–ø–∏—Å –∫–ª–∞—Å—É Node:
# –¶–µ –±–∞–∑–æ–≤–∞ –æ–¥–∏–Ω–∏—Ü—è –¥–ª—è –¥–≤–æ—Å–ø—Ä—è–º–æ–≤–∞–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É.
class Node:
    prev: Optional['Node']
    next: Optional['Node'] 

    """–í—É–∑–æ–ª –¥–≤–æ—Å–ø—Ä—è–º–æ–≤–∞–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É –¥–ª—è –∫–µ—à–∞. –ó–±–µ—Ä—ñ–≥–∞—î –∫–ª—é—á —ñ –∑–Ω–∞—á–µ–Ω–Ω—è."""
    # –ú–µ—Ç–æ–¥ __init__:
    def __init__(self, key, value):
        # data –∑–±–µ—Ä—ñ–≥–∞—î –∫–æ—Ä—Ç–µ–∂ (–∫–ª—é—á, –∑–Ω–∞—á–µ–Ω–Ω—è)
        self.data = (key, value)
        # –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –≤—É–∑–æ–ª (–ø–æ—á–∞—Ç–∫–æ–≤–æ None)
        self.next = None
        # –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –≤—É–∑–æ–ª (–ø–æ—á–∞—Ç–∫–æ–≤–æ None)
        self.prev = None


# –û–ø–∏—Å –∫–ª–∞—Å—É DoublyLinkedList:
# –†–µ–∞–ª—ñ–∑—É—î –¥–≤–æ—Å–ø—Ä—è–º–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫ –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –ø–æ—Ä—è–¥–∫—É LRU.
# head -> –Ω–∞–π–±—ñ–ª—å—à –Ω–µ—â–æ–¥–∞–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π (MRU); tail -> –Ω–∞–π–º–µ–Ω—à –Ω–µ—â–æ–¥–∞–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π (LRU).
class DoublyLinkedList:
    """–î–≤–æ—Å–ø—Ä—è–º–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫ –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –ø–æ—Ä—è–¥–∫—É LRU."""
    # –ú–µ—Ç–æ–¥ __init__:
    def __init__(self):
        # –í–∫–∞–∑—ñ–≤–Ω–∏–∫ –Ω–∞ –ø–æ—á–∞—Ç–æ–∫ —Å–ø–∏—Å–∫—É (MRU)
        self.head = None
        # –í–∫–∞–∑—ñ–≤–Ω–∏–∫ –Ω–∞ –∫—ñ–Ω–µ—Ü—å —Å–ø–∏—Å–∫—É (LRU)
        self.tail = None
        # –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É —Å–ø–∏—Å–∫—É
        self._size = 0

    # –ú–µ—Ç–æ–¥ push(key, value):
    # –î–æ–¥–∞—î –Ω–æ–≤–∏–π –≤—É–∑–æ–ª –Ω–∞ –ø–æ—á–∞—Ç–æ–∫ —Å–ø–∏—Å–∫—É. O(1).
    def push(self, key, value):
        """–î–æ–¥–∞—î –Ω–æ–≤–∏–π –≤—É–∑–æ–ª –Ω–∞ –ø–æ—á–∞—Ç–æ–∫ —Å–ø–∏—Å–∫—É (MRU)."""
        new_node = Node(key, value)
        # –ù–∞—Å—Ç—É–ø–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç –Ω–æ–≤–æ–≥–æ –≤—É–∑–ª–∞ ‚Äî —Ü–µ –ø–æ—Ç–æ—á–Ω–∏–π head
        new_node.next = self.head
        
        # –Ø–∫—â–æ —Å–ø–∏—Å–æ–∫ –Ω–µ –ø–æ—Ä–æ–∂–Ω—ñ–π:
        if self.head:
            # –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –µ–ª–µ–º–µ–Ω—Ç —Å—Ç–∞—Ä–æ–≥–æ head —Ç–µ–ø–µ—Ä –Ω–æ–≤–∏–π –≤—É–∑–æ–ª
            self.head.prev = new_node
        # –Ø–∫—â–æ —Å–ø–∏—Å–æ–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π:
        else:
            # –ù–æ–≤–∏–π –≤—É–∑–æ–ª —Å—Ç–∞—î —Ç–∞–∫–æ–∂ —ñ tail
            self.tail = new_node
            
        # –ù–æ–≤–∏–π –≤—É–∑–æ–ª —Å—Ç–∞—î –Ω–æ–≤–∏–º head
        self.head = new_node
        # –ó–±—ñ–ª—å—à—É—î–º–æ —Ä–æ–∑–º—ñ—Ä
        self._size += 1
        return new_node

    # –ú–µ—Ç–æ–¥ remove(node):
    # –í–∏–¥–∞–ª—è—î –∑–∞–¥–∞–Ω–∏–π –≤—É–∑–æ–ª –∑—ñ —Å–ø–∏—Å–∫—É, –ø—ñ–¥—Ç—Ä–∏–º—É—é—á–∏ –∑–≤'—è–∑–∫–∏. O(1).
    def remove(self, node):
        """–í–∏–¥–∞–ª—è—î –∑–∞–¥–∞–Ω–∏–π –≤—É–∑–æ–ª –∑—ñ —Å–ø–∏—Å–∫—É. –û–Ω–æ–≤–ª—é—î –ø–æ—Å–∏–ª–∞–Ω–Ω—è —Å—É—Å—ñ–¥—ñ–≤."""
        if not node:
            return
        
        # –Ø–∫—â–æ –≤—É–∑–æ–ª –º–∞—î –ø–æ–ø–µ—Ä–µ–¥–Ω–∏–∫–∞:
        if node.prev:
            # –ô–æ–≥–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–∫ —Ç–µ–ø–µ—Ä –≤–∫–∞–∑—É—î –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–∫–∞ –≤–∏–¥–∞–ª—è—î–º–æ–≥–æ –≤—É–∑–ª–∞
            node.prev.next = node.next
        # –Ø–∫—â–æ –≤—É–∑–æ–ª –Ω–µ –º–∞—î –ø–æ–ø–µ—Ä–µ–¥–Ω–∏–∫–∞ (—Ü–µ head):
        else:
            # head –ø–µ—Ä–µ–º—ñ—â—É—î—Ç—å—Å—è –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –≤—É–∑–æ–ª
            self.head = node.next
        
        # –Ø–∫—â–æ –≤—É–∑–æ–ª –º–∞—î –Ω–∞—Å—Ç—É–ø–Ω–∏–∫–∞:
        if node.next:
            # –ô–æ–≥–æ –ø–æ–ø–µ—Ä–µ–¥–Ω–∏–∫ —Ç–µ–ø–µ—Ä –≤–∫–∞–∑—É—î –Ω–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω–∏–∫–∞ –≤–∏–¥–∞–ª—è—î–º–æ–≥–æ –≤—É–∑–ª–∞
            node.next.prev = node.prev
        # –Ø–∫—â–æ –≤—É–∑–æ–ª –Ω–µ –º–∞—î –Ω–∞—Å—Ç—É–ø–Ω–∏–∫–∞ (—Ü–µ tail):
        else:
            # tail –ø–µ—Ä–µ–º—ñ—â—É—î—Ç—å—Å—è –Ω–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –≤—É–∑–æ–ª
            self.tail = node.prev
            
        # –û—á–∏—â–µ–Ω–Ω—è –ø–æ—Å–∏–ª–∞–Ω—å –≤–∏–¥–∞–ª–µ–Ω–æ–≥–æ –≤—É–∑–ª–∞
        node.prev = None
        node.next = None
        # –ó–º–µ–Ω—à—É—î–º–æ —Ä–æ–∑–º—ñ—Ä
        self._size -= 1

    # –ú–µ—Ç–æ–¥ move_to_front(node):
    # –ü–µ—Ä–µ–º—ñ—â—É—î –≤—É–∑–æ–ª –Ω–∞ –ø–æ–∑–∏—Ü—ñ—é head. O(1).
    def move_to_front(self, node):
        """–ü–µ—Ä–µ–º—ñ—â—É—î –≤—É–∑–æ–ª –Ω–∞ –ø–æ—á–∞—Ç–æ–∫ —Å–ø–∏—Å–∫—É (—Ä–æ–±–∏—Ç—å –π–æ–≥–æ MRU)."""
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞: —è–∫—â–æ –≤—É–∑–æ–ª –≤–∂–µ head, –Ω—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–∏–º–æ
        if node != self.head:
            # 1. –í–∏–¥–∞–ª—è—î–º–æ –≤—É–∑–æ–ª –∑ –ø–æ—Ç–æ—á–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó
            self.remove(node)
            # 2. –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ —Ä–æ–∑–º—ñ—Ä (–±–æ remove –∑–º–µ–Ω—à–∏–≤ –π–æ–≥–æ)
            self._size += 1 
            
            # –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –≤—É–∑–æ–ª —è–∫ –Ω–æ–≤–∏–π head
            node.next = self.head
            node.prev = None 
            
            # –Ø–∫—â–æ —Å–ø–∏—Å–æ–∫ –±—É–≤ –Ω–µ –ø–æ—Ä–æ–∂–Ω—ñ–π, —Å—Ç–∞—Ä–∏–π head –ø–æ–≤–∏–Ω–µ–Ω –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞–∑–∞–¥ –Ω–∞ –Ω–æ–≤–∏–π
            if self.head:
                self.head.prev = node
            # –Ø–∫—â–æ —Å–ø–∏—Å–æ–∫ —Å—Ç–∞–≤ –ø–æ—Ä–æ–∂–Ω—ñ–π –ø—ñ—Å–ª—è remove (–≤–∏–¥–∞–ª—è–ª–∏ —î–¥–∏–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç), 
            # node —Å—Ç–∞—î —Ç–∞–∫–æ–∂ —ñ tail
            else:
                self.tail = node 
                
            # –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ node —è–∫ –Ω–æ–≤–∏–π head
            self.head = node

    # –ú–µ—Ç–æ–¥ remove_last():
    # –í–∏–¥–∞–ª—è—î –µ–ª–µ–º–µ–Ω—Ç LRU (tail). O(1).
    def remove_last(self):
        """–í–∏–¥–∞–ª—è—î —ñ –ø–æ–≤–µ—Ä—Ç–∞—î –æ—Å—Ç–∞–Ω–Ω—ñ–π –≤—É–∑–æ–ª (LRU)."""
        if self.tail:
            last = self.tail
            self.remove(last) # –í–∏–∫–ª–∏–∫–∞—î–º–æ remove –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∑ tail
            return last
        return None

    # –ú–µ—Ç–æ–¥ __len__:
    # –î–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ len(list).
    def __len__(self):
        return self._size


# –û–ø–∏—Å –∫–ª–∞—Å—É LRUCache:
# –û–±'—î–¥–Ω—É—î —Å–ª–æ–≤–Ω–∏–∫ (cache) —Ç–∞ –¥–≤–æ—Å–ø—Ä—è–º–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫ (list).
class LRUCache:
    """–ö–µ—à –∑ –ø–æ–ª—ñ—Ç–∏–∫–æ—é Least Recently Used (LRU)."""
    # –ú–µ—Ç–æ–¥ __init__(capacity):
    def __init__(self, capacity):
        # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
        self.capacity = capacity
        # –°–ª–æ–≤–Ω–∏–∫: –∫–ª—é—á -> –æ–±'—î–∫—Ç Node (–¥–ª—è O(1) –¥–æ—Å—Ç—É–ø—É)
        self.cache = {} 
        # –î–≤–æ—Å–ø—Ä—è–º–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫ (–¥–ª—è O(1) –∫–µ—Ä—É–≤–∞–Ω–Ω—è –ø–æ—Ä—è–¥–∫–æ–º LRU)
        self.list = DoublyLinkedList()

    # –ú–µ—Ç–æ–¥ get(key): O(1).
    def get(self, key):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∫–ª—é—á–µ–º. –ü—Ä–∏ –≤–ª—É—á–∞–Ω–Ω—ñ –ø–µ—Ä–µ–º—ñ—â—É—î –µ–ª–µ–º–µ–Ω—Ç –Ω–∞ –ø–æ—á–∞—Ç–æ–∫."""
        if key in self.cache:
            node = self.cache[key]
            # –ö–µ—à-–≤–ª—É—á–∞–Ω–Ω—è: —Ä–æ–±–∏–º–æ –≤—É–∑–æ–ª –Ω–∞–π–±—ñ–ª—å—à –Ω–µ—â–æ–¥–∞–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–º
            self.list.move_to_front(node)
            # –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è (—ñ–Ω–¥–µ–∫—Å 1 —É –∫–æ—Ä—Ç–µ–∂—ñ data)
            return node.data[1] 
        # –ö–µ—à-–ø—Ä–æ–º–∞—Ö
        return -1 

    # –ú–µ—Ç–æ–¥ put(key, value): O(1).
    def put(self, key, value):
        """–î–æ–¥–∞—Ç–∏ –∞–±–æ –æ–Ω–æ–≤–∏—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç —É –∫–µ—à—ñ. –û–±—Ä–æ–±–ª—è—î –≤–∏—Ç—ñ—Å–Ω–µ–Ω–Ω—è LRU."""
        if key in self.cache:
            # –û–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ—Å–Ω—É—é—á–æ–≥–æ –∫–ª—é—á–∞:
            node = self.cache[key]
            node.data = (key, value) # –û–Ω–æ–≤–ª—é—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è
            self.list.move_to_front(node) # –ü–µ—Ä–µ–º—ñ—â—É—î–º–æ –Ω–∞ –ø–æ—á–∞—Ç–æ–∫
        else:
            # –í—Å—Ç–∞–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –∫–ª—é—á–∞:
            # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –∫–µ—à –ø–æ–≤–Ω–∏–π
            if len(self.cache) >= self.capacity:
                # –í–∏—Ç—ñ—Å–Ω–µ–Ω–Ω—è LRU: –≤–∏–¥–∞–ª—è—î–º–æ –Ω–∞–π–º–µ–Ω—à –Ω–µ—â–æ–¥–∞–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π (–∑ tail)
                last = self.list.remove_last()
                if last:
                    # –í–∏–¥–∞–ª—è—î–º–æ –∫–ª—é—á —ñ–∑ —Å–ª–æ–≤–Ω–∏–∫–∞ –∫–µ—à–∞
                    del self.cache[last.data[0]] 
            
            # –î–æ–¥–∞—î–º–æ –Ω–æ–≤–∏–π –µ–ª–µ–º–µ–Ω—Ç –Ω–∞ –ø–æ—á–∞—Ç–æ–∫ —Å–ø–∏—Å–∫—É
            new_node = self.list.push(key, value)
            self.cache[key] = new_node
            
    # –ú–µ—Ç–æ–¥ invalidate_key(key_to_delete):
    def invalidate_key(self, key_to_delete):
        """–í–∏–¥–∞–ª—è—î –µ–ª–µ–º–µ–Ω—Ç —ñ–∑ –∫–µ—à–∞ –∑–∞ –∫–ª—é—á–µ–º (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —ñ–Ω–≤–∞–ª—ñ–¥–∞—Ü—ñ—ó)."""
        if key_to_delete in self.cache:
            node = self.cache[key_to_delete]
            self.list.remove(node) # –í–∏–¥–∞–ª—è—î–º–æ –∑—ñ —Å–ø–∏—Å–∫—É
            del self.cache[key_to_delete] # –í–∏–¥–∞–ª—è—î–º–æ –∑—ñ —Å–ª–æ–≤–Ω–∏–∫–∞

# ---  –¢–ï–•–ù–Ü–ß–ù–Ü –§–£–ù–ö–¶–Ü–á –î–õ–Ø –î–ï–ú–û–ù–°–¢–†–ê–¶–Ü–á –ü–†–ò–°–ö–û–†–ï–ù–ù–Ø ---

# range_sum_no_cache:
def range_sum_no_cache(array, left, right):
    """–û–±—á–∏—Å–ª—é—î —Å—É–º—É –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ array[left:right+1] –±–µ–∑ –∫–µ—à—É–≤–∞–Ω–Ω—è (O(R-L))."""
    # –û–±—á–∏—Å–ª–µ–Ω–Ω—è —Å—É–º–∏ –¥—ñ–∞–ø–∞–∑–æ–Ω—É. –ó—Ä—ñ–∑ R+1 –≤–∫–ª—é—á–∞—î –µ–ª–µ–º–µ–Ω—Ç –∑–∞ —ñ–Ω–¥–µ–∫—Å–æ–º R.
    return sum(array[left : right + 1])

# update_no_cache:
def update_no_cache(array, index, value):
    """–û–Ω–æ–≤–ª—é—î –µ–ª–µ–º–µ–Ω—Ç –º–∞—Å–∏–≤—É array[index] = value –±–µ–∑ –∫–µ—à—É–≤–∞–Ω–Ω—è (O(1))."""
    # –ü—Ä—è–º–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è –≤ –º–∞—Å–∏–≤—ñ
    array[index] = value

# range_sum_with_cache:
# –ü—Ä–∏–π–º–∞—î –µ–∫–∑–µ–º–ø–ª—è—Ä –∫–µ—à–∞ —è–∫ –∞—Ä–≥—É–º–µ–Ω—Ç (cache)
def range_sum_with_cache(array, cache, left, right):
    """–û–±—á–∏—Å–ª—é—î —Å—É–º—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ LRUCache, –ø–µ—Ä–µ–¥–∞–Ω–∏–π —è–∫ –∞—Ä–≥—É–º–µ–Ω—Ç. O(1) –∞–±–æ O(R-L)."""
    # –ö–ª—é—á –∫–µ—à–∞ - —Ü–µ –∫–æ—Ä—Ç–µ–∂ (L, R)
    key = (left, right)
    
    # 1. –°–ø—Ä–æ–±–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑ –∫–µ—à–∞. O(1).
    cached_sum = cache.get(key)
    
    if cached_sum != -1:
        # Cache Hit: –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –∫–µ—à–æ–≤–∞–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è
        return cached_sum
    else:
        # Cache Miss: –æ–±—á–∏—Å–ª—é—î–º–æ —Å—É–º—É
        current_sum = sum(array[left : right + 1])
        
        # –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É –∫–µ—à –¥–ª—è –º–∞–π–±—É—Ç–Ω—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è. O(1).
        cache.put(key, current_sum)
        
        return current_sum

# update_with_cache:
# –ü—Ä–∏–π–º–∞—î –µ–∫–∑–µ–º–ø–ª—è—Ä –∫–µ—à–∞ —è–∫ –∞—Ä–≥—É–º–µ–Ω—Ç (cache)
def update_with_cache(array, cache, index, value):
    """–û–Ω–æ–≤–ª—é—î –º–∞—Å–∏–≤ —Ç–∞ —ñ–Ω–≤–∞–ª—ñ–¥—É—î –∫–µ—à. O(1) + O(K) –¥–ª—è —ñ–Ω–≤–∞–ª—ñ–¥–∞—Ü—ñ—ó."""
    
    # 1. –û–Ω–æ–≤–ª–µ–Ω–Ω—è –º–∞—Å–∏–≤—É. O(1).
    array[index] = value
    
    # 2. –Ü–Ω–≤–∞–ª—ñ–¥–∞—Ü—ñ—è –∫–µ—à–∞
    keys_to_invalidate = []
    # –õ—ñ–Ω—ñ–π–Ω–∏–π –ø—Ä–æ—Ö—ñ–¥ –ø–æ –≤—Å—ñ—Ö –∫–ª—é—á–∞—Ö –∫–µ—à–∞. O(K), –¥–µ K - —î–º–Ω—ñ—Å—Ç—å –∫–µ—à–∞.
    for key in cache.cache.keys():
        left, right = key
        # –Ø–∫—â–æ –∑–º—ñ–Ω–µ–Ω–∏–π —ñ–Ω–¥–µ–∫—Å (index) –ø–æ—Ç—Ä–∞–ø–ª—è—î —É –∫–µ—à–æ–≤–∞–Ω–∏–π –¥—ñ–∞–ø–∞–∑–æ–Ω [L, R]
        if left <= index <= right:
            keys_to_invalidate.append(key)
            
    # –í–∏–¥–∞–ª–µ–Ω–Ω—è —ñ–Ω–≤–∞–ª—ñ–¥–æ–≤–∞–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –∑ –∫–µ—à–∞
    for key in keys_to_invalidate:
        cache.invalidate_key(key) # O(1)

# make_queries:
# –§—É–Ω–∫—Ü—ñ—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∑–∞–ø–∏—Ç—ñ–≤ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ —Ç–µ—Ö–Ω—ñ—á–Ω–∏—Ö —É–º–æ–≤.
def make_queries(n, q, hot_pool=30, p_hot=0.95, p_update=0.03):
    """–ì–µ–Ω–µ—Ä—É—î Q –∑–∞–ø–∏—Ç—ñ–≤ (Range —Ç–∞ Update) –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –ø—É–ª—É "–≥–∞—Ä—è—á–∏—Ö" –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤."""
    random.seed(42) # –§—ñ–∫—Å—É—î–º–æ seed –¥–ª—è –≤—ñ–¥—Ç–≤–æ—Ä—é–≤–∞–Ω–æ—Å—Ç—ñ —Ç–µ—Å—Ç—ñ–≤
    
    # –°—Ç–≤–æ—Ä—é—î–º–æ –ø—É–ª "–≥–∞—Ä—è—á–∏—Ö" –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤ [L, R]
    hot = [(random.randint(0, n//2), random.randint(n//2, n-1)) 
           for _ in range(hot_pool)]
    
    queries = []
    for _ in range(q):
        # ~3% –∑–∞–ø–∏—Ç—ñ–≤ ‚Äî Update
        if random.random() < p_update:        
            idx = random.randint(0, n-1)
            val = random.randint(1, 100)
            queries.append(("Update", idx, val))
        # ~97% –∑–∞–ø–∏—Ç—ñ–≤ ‚Äî Range
        else:                                 
            # 95% –∑ Range-–∑–∞–ø–∏—Ç—ñ–≤ ‚Äî –∑ "–≥–∞—Ä—è—á–æ–≥–æ" –ø—É–ª—É
            if random.random() < p_hot:       
                left, right = random.choice(hot)
            # 5% –∑ Range-–∑–∞–ø–∏—Ç—ñ–≤ ‚Äî –ø–æ–≤–Ω—ñ—Å—Ç—é –≤–∏–ø–∞–¥–∫–æ–≤—ñ
            else:                             
                left = random.randint(0, n-1)
                right = random.randint(left, n-1)
            queries.append(("Range", left, right))
            
    return queries

# ---  –û–°–ù–û–í–ù–ò–ô –ë–õ–û–ö –í–ò–ö–û–ù–ê–ù–ù–Ø –¢–ê –¢–ï–°–¢–£–í–ê–ù–ù–Ø ---

if __name__ == "__main__":
    
    # –¢–µ—Ö–Ω—ñ—á–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
    N = 100_000 # –†–æ–∑–º—ñ—Ä –º–∞—Å–∏–≤—É
    Q = 50_000  # –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤
    K = 1000    # –Ñ–º–Ω—ñ—Å—Ç—å LRU-–∫–µ—à–∞
    
    print(f"–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è: N={N}, Q={Q}, K={K}")
    print("---------------------------------------")

    # 1. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö
    random.seed(42) # –§—ñ–∫—Å—É—î–º–æ seed –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –º–∞—Å–∏–≤—É
    # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ –º–∞—Å–∏–≤—É
    initial_array = [random.randint(1, 100) for _ in range(N)]
    # –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –∑–∞–ø–∏—Ç—ñ–≤
    queries = make_queries(N, Q) 

    # 2. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ë–ï–ó –ö–ï–®–£
    
    # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–ø—ñ—ó –º–∞—Å–∏–≤—É –¥–ª—è –ø–µ—Ä—à–æ–≥–æ —Ç–µ—Å—Ç—É
    array_no_cache = list(initial_array) 
    
    # –ü–æ—á–∞—Ç–æ–∫ –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è —á–∞—Å—É
    start_time_no_cache = time.perf_counter()
    
    # –í–∏–∫–æ–Ω–∞–Ω–Ω—è –≤—Å—ñ—Ö Q –∑–∞–ø–∏—Ç—ñ–≤ –±–µ–∑ –∫–µ—à—É
    for query in queries:
        op_type = query[0]
        if op_type == "Range":
            L, R = query[1], query[2]
            # –í–∏–∫–ª–∏–∫–∞—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é range_sum_no_cache
            _ = range_sum_no_cache(array_no_cache, L, R) 
        elif op_type == "Update":
            index, value = query[1], query[2]
            # –í–∏–∫–ª–∏–∫–∞—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é update_no_cache
            update_no_cache(array_no_cache, index, value)
            
    # –ö—ñ–Ω–µ—Ü—å –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è —á–∞—Å—É
    end_time_no_cache = time.perf_counter()
    time_no_cache = end_time_no_cache - start_time_no_cache
    
    # 3. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ó –ö–ï–®–ï–ú LRU
    
    # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–ø—ñ—ó –º–∞—Å–∏–≤—É –¥–ª—è –¥—Ä—É–≥–æ–≥–æ —Ç–µ—Å—Ç—É
    array_with_cache = list(initial_array) 
    # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–µ—à–∞
    lru_cache = LRUCache(K) 
    
    # –ü–æ—á–∞—Ç–æ–∫ –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è —á–∞—Å—É
    start_time_with_cache = time.perf_counter()
    
    # –í–∏–∫–æ–Ω–∞–Ω–Ω—è –≤—Å—ñ—Ö Q –∑–∞–ø–∏—Ç—ñ–≤ –∑ –∫–µ—à–µ–º
    for query in queries:
        op_type = query[0]
        if op_type == "Range":
            L, R = query[1], query[2]
            # –í–∏–∫–ª–∏–∫–∞—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é, –ø–µ—Ä–µ–¥–∞—é—á–∏ lru_cache —è–∫ –∞—Ä–≥—É–º–µ–Ω—Ç
            _ = range_sum_with_cache(array_with_cache, lru_cache, L, R) 
        elif op_type == "Update":
            index, value = query[1], query[2]
            # –í–∏–∫–ª–∏–∫–∞—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é, –ø–µ—Ä–µ–¥–∞—é—á–∏ lru_cache —è–∫ –∞—Ä–≥—É–º–µ–Ω—Ç
            update_with_cache(array_with_cache, lru_cache, index, value) 
            
    # –ö—ñ–Ω–µ—Ü—å –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è —á–∞—Å—É
    end_time_with_cache = time.perf_counter()
    time_with_cache = end_time_with_cache - start_time_with_cache
    
    # 4. –í–∏–≤–µ–¥–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
    
    # –û–±—á–∏—Å–ª–µ–Ω–Ω—è –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è
    speedup = time_no_cache / time_with_cache if time_with_cache > 0 else 0
    
    print("\n –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è —á–∞—Å—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤")
    # –í–∏–≤–µ–¥–µ–Ω–Ω—è —á–∞—Å—É –±–µ–∑ –∫–µ—à—É
    print(f"–ë–µ–∑ –∫–µ—à—É: \t {time_no_cache:.2f} c")
    # –í–∏–≤–µ–¥–µ–Ω–Ω—è —á–∞—Å—É –∑ –∫–µ—à–µ–º
    print(f"LRU-–∫–µ—à: \t {time_with_cache:.2f} c")
    # –í–∏–≤–µ–¥–µ–Ω–Ω—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞ –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è
    print(f"–ü—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è: \t √ó{speedup:.1f}")
    print("---------------------------------------")
    
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –ª–æ–≥—ñ—á–Ω—É –∫–æ—Ä–µ–∫—Ç–Ω—ñ—Å—Ç—å (—Ñ—ñ–Ω–∞–ª—å–Ω—ñ —Å—Ç–∞–Ω–∏ –º–∞—Å–∏–≤—ñ–≤ –º–∞—é—Ç—å –∑–±—ñ–≥–∞—Ç–∏—Å—è)
    if array_no_cache != array_with_cache:
        print("‚ùó –ü–û–ú–ò–õ–ö–ê: –§—ñ–Ω–∞–ª—å–Ω—ñ –º–∞—Å–∏–≤–∏ –Ω–µ –∑–±—ñ–≥–∞—é—Ç—å—Å—è. –õ–æ–≥—ñ—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞.")
    else:
        print("–ú–∞—Å–∏–≤–∏ –ø—ñ—Å–ª—è –æ–ø–µ—Ä–∞—Ü—ñ–π –∑–±—ñ–≥–∞—é—Ç—å—Å—è. –¢–µ—Å—Ç –∫–æ—Ä–µ–∫—Ç–Ω–∏–π.")




# #  –ö–æ–¥ —ñ–∑ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—é –≤—ñ–¥ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞–Ω—É (–ö–æ–¥, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≥–ª–æ–±–∞–ª—å–Ω–∏–π —Å—Ç–∞–Ω)
# # --- üß± –ë–ê–ó–û–í–ò–ô –ö–û–î: LRU-–ö–ï–® –ù–ê –û–°–ù–û–í–Ü –î–í–û–°–ü–†–Ø–ú–û–í–ê–ù–û–ì–û –°–ü–ò–°–ö–£ –¢–ê –°–õ–û–í–ù–ò–ö–ê ---

# # –û–ø–∏—Å –∫–ª–∞—Å—É Node:
# # –¶–µ –±–∞–∑–æ–≤–∞ –æ–¥–∏–Ω–∏—Ü—è –¥–ª—è –¥–≤–æ—Å–ø—Ä—è–º–æ–≤–∞–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É (DoublyLinkedList).
# # –ö–æ–∂–µ–Ω –≤—É–∑–æ–ª –∑–±–µ—Ä—ñ–≥–∞—î **–∫–ª—é—á** —ñ **–∑–Ω–∞—á–µ–Ω–Ω—è** (—è–∫—ñ —Ä–∞–∑–æ–º —É—Ç–≤–æ—Ä—é—é—Ç—å data) —Ç–∞
# # –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π (prev) —ñ –Ω–∞—Å—Ç—É–ø–Ω–∏–π (next) –≤—É–∑–ª–∏.
# class Node:
#     """–í—É–∑–æ–ª –¥–≤–æ—Å–ø—Ä—è–º–æ–≤–∞–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É –¥–ª—è –∫–µ—à–∞. –ó–±–µ—Ä—ñ–≥–∞—î –∫–ª—é—á —ñ –∑–Ω–∞—á–µ–Ω–Ω—è."""
#     # –ú–µ—Ç–æ–¥ __init__:
#     # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î –Ω–æ–≤–∏–π –≤—É–∑–æ–ª –∑ –∑–∞–¥–∞–Ω–∏–º–∏ –∫–ª—é—á–µ–º —ñ –∑–Ω–∞—á–µ–Ω–Ω—è–º.
#     # data –∑–±–µ—Ä—ñ–≥–∞—î –∫–æ—Ä—Ç–µ–∂ (–∫–ª—é—á, –∑–Ω–∞—á–µ–Ω–Ω—è).
#     # prev —Ç–∞ next –ø–æ—á–∞—Ç–∫–æ–≤–æ None.
#     def __init__(self, key, value):
#         self.data = (key, value)
#         self.next = None
#         self.prev = None


# # –û–ø–∏—Å –∫–ª–∞—Å—É DoublyLinkedList:
# # –†–µ–∞–ª—ñ–∑—É—î –¥–≤–æ—Å–ø—Ä—è–º–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫, —è–∫–∏–π –ø—ñ–¥—Ç—Ä–∏–º—É—î –ø–æ—Ä—è–¥–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç—ñ–≤.
# # **head** –∑–∞–≤–∂–¥–∏ –≤–∫–∞–∑—É—î –Ω–∞ –Ω–∞–π–±—ñ–ª—å—à –Ω–µ—â–æ–¥–∞–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç (MRU).
# # **tail** –∑–∞–≤–∂–¥–∏ –≤–∫–∞–∑—É—î –Ω–∞ –Ω–∞–π–º–µ–Ω—à –Ω–µ—â–æ–¥–∞–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç (LRU).
# class DoublyLinkedList:
#     """–î–≤–æ—Å–ø—Ä—è–º–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫ –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –ø–æ—Ä—è–¥–∫—É LRU."""
#     # –ú–µ—Ç–æ–¥ __init__:
#     # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î –ø–æ—Ä–æ–∂–Ω—ñ–π —Å–ø–∏—Å–æ–∫. head —ñ tail –¥–æ—Ä—ñ–≤–Ω—é—é—Ç—å None.
#     # _size –≤—ñ–¥—Å—Ç–µ–∂—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤—É–∑–ª—ñ–≤.
#     def __init__(self):
#         self.head = None
#         self.tail = None
#         self._size = 0

#     # –ú–µ—Ç–æ–¥ push(key, value):
#     # –î–æ–¥–∞—î –Ω–æ–≤–∏–π –≤—É–∑–æ–ª –Ω–∞ –ø–æ—á–∞—Ç–æ–∫ —Å–ø–∏—Å–∫—É (—è–∫ –Ω–æ–≤–∏–π head).
#     # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, –∫–æ–ª–∏ –µ–ª–µ–º–µ–Ω—Ç —â–æ–π–Ω–æ –¥–æ–¥–∞—î—Ç—å—Å—è –∞–±–æ –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è –≤ –∫–µ—à—ñ.
#     def push(self, key, value):
#         """–î–æ–¥–∞—î –Ω–æ–≤–∏–π –≤—É–∑–æ–ª –Ω–∞ –ø–æ—á–∞—Ç–æ–∫ —Å–ø–∏—Å–∫—É (MRU)."""
#         new_node = Node(key, value)
#         # –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è new_node.next –Ω–∞ –ø–æ—Ç–æ—á–Ω–∏–π head
#         new_node.next = self.head
        
#         # –Ø–∫—â–æ —Å–ø–∏—Å–æ–∫ –Ω–µ –ø–æ—Ä–æ–∂–Ω—ñ–π (—Ç–æ–±—Ç–æ head —ñ—Å–Ω—É—î):
#         if self.head:
#             # –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –µ–ª–µ–º–µ–Ω—Ç —Å—Ç–∞—Ä–æ–≥–æ head —Ç–µ–ø–µ—Ä –Ω–æ–≤–∏–π –≤—É–∑–æ–ª
#             self.head.prev = new_node
#         # –Ø–∫—â–æ —Å–ø–∏—Å–æ–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π:
#         else:
#             # –ù–æ–≤–∏–π –≤—É–∑–æ–ª —Å—Ç–∞—î —Ç–∞–∫–æ–∂ —ñ tail
#             self.tail = new_node
            
#         # –ù–æ–≤–∏–π –≤—É–∑–æ–ª —Å—Ç–∞—î –Ω–æ–≤–∏–º head
#         self.head = new_node
#         self._size += 1
#         return new_node

#     # –ú–µ—Ç–æ–¥ remove(node):
#     # –í–∏–¥–∞–ª—è—î –∑–∞–¥–∞–Ω–∏–π –≤—É–∑–æ–ª –∑—ñ —Å–ø–∏—Å–∫—É. –¶–µ –æ–ø–µ—Ä–∞—Ü—ñ—è O(1).
#     # –í–∞–∂–ª–∏–≤–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–Ω–æ–≤–∏—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è —Å—É—Å—ñ–¥–Ω—ñ—Ö –≤—É–∑–ª—ñ–≤ —Ç–∞ head/tail.
#     def remove(self, node):
#         """–í–∏–¥–∞–ª—è—î –∑–∞–¥–∞–Ω–∏–π –≤—É–∑–æ–ª –∑—ñ —Å–ø–∏—Å–∫—É. –û–Ω–æ–≤–ª—é—î –ø–æ—Å–∏–ª–∞–Ω–Ω—è —Å—É—Å—ñ–¥—ñ–≤."""
#         if not node:
#             return
        
#         # –ó'—î–¥–Ω—É—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –≤—É–∑–æ–ª –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏–º
#         if node.prev:
#             # node.prev.next —Ç–µ–ø–µ—Ä –º–∞—î –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ node.next
#             node.prev.next = node.next
#         else:
#             # –Ø–∫—â–æ node.prev == None, —Ü–µ –±—É–≤ head, —Ç–æ–º—É head –ø–µ—Ä–µ–º—ñ—â—É—î—Ç—å—Å—è –Ω–∞ node.next
#             self.head = node.next
        
#         # –ó'—î–¥–Ω—É—î–º–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –≤—É–∑–æ–ª –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º
#         if node.next:
#             # node.next.prev —Ç–µ–ø–µ—Ä –º–∞—î –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ node.prev
#             node.next.prev = node.prev
#         else:
#             # –Ø–∫—â–æ node.next == None, —Ü–µ –±—É–≤ tail, —Ç–æ–º—É tail –ø–µ—Ä–µ–º—ñ—â—É—î—Ç—å—Å—è –Ω–∞ node.prev
#             self.tail = node.prev
            
#         # –û—á–∏—â–µ–Ω–Ω—è –ø–æ—Å–∏–ª–∞–Ω—å –≤–∏–¥–∞–ª–µ–Ω–æ–≥–æ –≤—É–∑–ª–∞ –¥–ª—è GC
#         node.prev = None
#         node.next = None
#         self._size -= 1

#     # –ú–µ—Ç–æ–¥ move_to_front(node):
#     # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ø—Ä–∏ –∫–µ—à-–≤–ª—É—á–∞–Ω–Ω—ñ (Cache Hit) –∞–±–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ.
#     # –°–ø–æ—á–∞—Ç–∫—É –≤–∏–¥–∞–ª—è—î –≤—É–∑–æ–ª –∑ –ø–æ—Ç–æ—á–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó, –∞ –ø–æ—Ç—ñ–º –¥–æ–¥–∞—î –π–æ–≥–æ –Ω–∞ –ø–æ—á–∞—Ç–æ–∫ (—è–∫ –Ω–æ–≤–∏–π head).
#     def move_to_front(self, node):
#         """–ü–µ—Ä–µ–º—ñ—â—É—î –≤—É–∑–æ–ª –Ω–∞ –ø–æ—á–∞—Ç–æ–∫ —Å–ø–∏—Å–∫—É (—Ä–æ–±–∏—Ç—å –π–æ–≥–æ MRU)."""
#         # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞: —è–∫—â–æ –≤—É–∑–æ–ª –≤–∂–µ head, –Ω—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–∏–º–æ
#         if node != self.head:
#             # 1. –í–∏–¥–∞–ª—è—î–º–æ –≤—É–∑–æ–ª –∑ –ø–æ—Ç–æ—á–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó
#             self.remove(node)
#             # 2. –î–æ–¥–∞—î–º–æ –≤—É–∑–æ–ª —è–∫ –Ω–æ–≤–∏–π head (—Ü–µ –∫–æ–ø—ñ—è –ª–æ–≥—ñ–∫–∏ push –¥–ª—è —ñ—Å–Ω—É—é—á–æ–≥–æ –≤—É–∑–ª–∞)
#             self._size += 1 # –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ —Ä–æ–∑–º—ñ—Ä, —è–∫–∏–π –∑–º–µ–Ω—à–∏–≤ remove
            
#             node.next = self.head
#             node.prev = None 
            
#             if self.head:
#                 self.head.prev = node
#             else:
#                 self.tail = node 
                
#             self.head = node

#     # –ú–µ—Ç–æ–¥ remove_last():
#     # –í–∏–¥–∞–ª—è—î –Ω–∞–π–º–µ–Ω—à –Ω–µ—â–æ–¥–∞–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –≤—É–∑–æ–ª (LRU), —è–∫–∏–π –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —É tail.
#     # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, –∫–æ–ª–∏ –∫–µ—à –ø–æ–≤–Ω–∏–π —ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–≤—ñ–ª—å–Ω–∏—Ç–∏ –º—ñ—Å—Ü–µ.
#     def remove_last(self):
#         """–í–∏–¥–∞–ª—è—î —ñ –ø–æ–≤–µ—Ä—Ç–∞—î –æ—Å—Ç–∞–Ω–Ω—ñ–π –≤—É–∑–æ–ª (LRU)."""
#         if self.tail:
#             last = self.tail
#             self.remove(last) # –í–∏–¥–∞–ª—è—î–º–æ –π–æ–≥–æ –∑—ñ —Å–ø–∏—Å–∫—É
#             return last
#         return None

#     # –ú–µ—Ç–æ–¥ __len__:
#     # –î–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ len(—Å–ø–∏—Å–æ–∫).
#     def __len__(self):
#         return self._size


# # –û–ø–∏—Å –∫–ª–∞—Å—É LRUCache:
# # –ö–æ–º–±—ñ–Ω—É—î —Å–ª–æ–≤–Ω–∏–∫ (self.cache) –¥–ª—è O(1) –ø–æ—à—É–∫—É –≤—É–∑–ª–∞ –∑–∞ –∫–ª—é—á–µ–º —ñ 
# # –¥–≤–æ—Å–ø—Ä—è–º–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫ (self.list) –¥–ª—è O(1) –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ—Ä—è–¥–∫—É LRU.
# class LRUCache:
#     """–ö–µ—à –∑ –ø–æ–ª—ñ—Ç–∏–∫–æ—é Least Recently Used (LRU)."""
#     # –ú–µ—Ç–æ–¥ __init__(capacity):
#     # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î –∫–µ—à –∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—é —î–º–Ω—ñ—Å—Ç—é.
#     # self.cache - —Å–ª–æ–≤–Ω–∏–∫: –∫–ª—é—á -> –æ–±'—î–∫—Ç Node
#     # self.list - –¥–≤–æ—Å–ø—Ä—è–º–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫
#     def __init__(self, capacity):
#         self.capacity = capacity
#         self.cache = {} 
#         self.list = DoublyLinkedList()

#     # –ú–µ—Ç–æ–¥ get(key):
#     # –°–ø—Ä–æ–±–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∫–ª—é—á–µ–º.
#     def get(self, key):
#         """–û—Ç—Ä–∏–º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∫–ª—é—á–µ–º. –ü—Ä–∏ –≤–ª—É—á–∞–Ω–Ω—ñ –ø–µ—Ä–µ–º—ñ—â—É—î –µ–ª–µ–º–µ–Ω—Ç –Ω–∞ –ø–æ—á–∞—Ç–æ–∫."""
#         if key in self.cache:
#             node = self.cache[key]
#             # –í–ª—É—á–∞–Ω–Ω—è: –µ–ª–µ–º–µ–Ω—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤—Å—è, –ø–µ—Ä–µ–º—ñ—â—É—î–º–æ –π–æ–≥–æ –Ω–∞ –ø–æ—á–∞—Ç–æ–∫ (MRU)
#             self.list.move_to_front(node)
#             # –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è (node.data[1] - —Ü–µ –∑–Ω–∞—á–µ–Ω–Ω—è)
#             return node.data[1] 
#         # –ü—Ä–æ–º–∞—Ö: –µ–ª–µ–º–µ–Ω—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ
#         return -1 

#     # –ú–µ—Ç–æ–¥ put(key, value):
#     # –î–æ–¥–∞—Ç–∏ –∞–±–æ –æ–Ω–æ–≤–∏—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç —É –∫–µ—à—ñ.
#     def put(self, key, value):
#         """–î–æ–¥–∞—Ç–∏ –∞–±–æ –æ–Ω–æ–≤–∏—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç —É –∫–µ—à—ñ. –û–±—Ä–æ–±–ª—è—î –≤–∏—Ç—ñ—Å–Ω–µ–Ω–Ω—è LRU, —è–∫—â–æ –∫–µ—à –ø–æ–≤–Ω–∏–π."""
#         if key in self.cache:
#             # –í–∏–ø–∞–¥–æ–∫ 1: –û–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ—Å–Ω—É—é—á–æ–≥–æ –∫–ª—é—á–∞ (Cache Hit)
#             node = self.cache[key]
#             node.data = (key, value) # –û–Ω–æ–≤–ª—é—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è —É –≤—É–∑–ª—ñ
#             self.list.move_to_front(node) # –ü–µ—Ä–µ–º—ñ—â—É—î–º–æ –Ω–∞ –ø–æ—á–∞—Ç–æ–∫
#         else:
#             # –í–∏–ø–∞–¥–æ–∫ 2: –í—Å—Ç–∞–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –∫–ª—é—á–∞ (Cache Miss)
#             # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏—Ç—ñ—Å–Ω–∏—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç (–≤–∏–¥–∞–ª–µ–Ω–Ω—è LRU)
#             if len(self.cache) >= self.capacity:
#                 # –í–∏–¥–∞–ª—è—î–º–æ –Ω–∞–π–º–µ–Ω—à –Ω–µ—â–æ–¥–∞–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π (–∑ –∫—ñ–Ω—Ü—è —Å–ø–∏—Å–∫—É)
#                 last = self.list.remove_last()
#                 if last:
#                     # –í–∏–¥–∞–ª—è—î–º–æ –∫–ª—é—á –∑ –¥–æ–ø–æ–º—ñ–∂–Ω–æ–≥–æ —Å–ª–æ–≤–Ω–∏–∫–∞ –∫–µ—à–∞
#                     del self.cache[last.data[0]] 
            
#             # –î–æ–¥–∞—î–º–æ –Ω–æ–≤–∏–π –µ–ª–µ–º–µ–Ω—Ç –Ω–∞ –ø–æ—á–∞—Ç–æ–∫ —Å–ø–∏—Å–∫—É (push)
#             new_node = self.list.push(key, value)
#             self.cache[key] = new_node
            
#     # –ú–µ—Ç–æ–¥ invalidate_key(key_to_delete):
#     # –î–æ–ø–æ–º—ñ–∂–Ω–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç–∞ –ø—Ä–∏ —ñ–Ω–≤–∞–ª—ñ–¥–∞—Ü—ñ—ó.
#     def invalidate_key(self, key_to_delete):
#         """–í–∏–¥–∞–ª—è—î –µ–ª–µ–º–µ–Ω—Ç —ñ–∑ –∫–µ—à–∞ –∑–∞ –∫–ª—é—á–µ–º (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —ñ–Ω–≤–∞–ª—ñ–¥–∞—Ü—ñ—ó)."""
#         if key_to_delete in self.cache:
#             node = self.cache[key_to_delete]
#             self.list.remove(node) # –í–∏–¥–∞–ª—è—î–º–æ –∑—ñ —Å–ø–∏—Å–∫—É
#             del self.cache[key_to_delete] # –í–∏–¥–∞–ª—è—î–º–æ –∑—ñ —Å–ª–æ–≤–Ω–∏–∫–∞

# # ---  –¢–ï–•–ù–Ü–ß–ù–Ü –§–£–ù–ö–¶–Ü–á –î–õ–Ø –î–ï–ú–û–ù–°–¢–†–ê–¶–Ü–á –ü–†–ò–°–ö–û–†–ï–ù–ù–Ø ---

# # –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –¥–ª—è —î–º–Ω–æ—Å—Ç—ñ –∫–µ—à–∞
# CACHE_CAPACITY = 1000
# # –ì–ª–æ–±–∞–ª—å–Ω–∞ –∑–º—ñ–Ω–Ω–∞ –¥–ª—è –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–µ—à–∞
# lru_cache = None 

# # 1. –§—É–Ω–∫—Ü—ñ—ó –ë–ï–ó –ö–ï–®–£

# # range_sum_no_cache:
# # –ü—Ä–æ—Å—Ç–µ –ª—ñ–Ω—ñ–π–Ω–µ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Å—É–º–∏ –¥—ñ–∞–ø–∞–∑–æ–Ω—É.
# def range_sum_no_cache(array, left, right):
#     """–û–±—á–∏—Å–ª—é—î —Å—É–º—É –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ array[left:right+1] –±–µ–∑ –∫–µ—à—É–≤–∞–Ω–Ω—è (O(R-L))."""
#     # –ó—Ä—ñ–∑ Python array[L : R + 1] –≤–∫–ª—é—á–∞—î –æ–±–∏–¥–≤–∞ –∫—ñ–Ω—Ü—ñ L —ñ R.
#     return sum(array[left : right + 1])

# # update_no_cache:
# # –ü—Ä–æ—Å—Ç–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç–∞.
# def update_no_cache(array, index, value):
#     """–û–Ω–æ–≤–ª—é—î –µ–ª–µ–º–µ–Ω—Ç –º–∞—Å–∏–≤—É array[index] = value –±–µ–∑ –∫–µ—à—É–≤–∞–Ω–Ω—è (O(1))."""
#     array[index] = value

# # 2. –§—É–Ω–∫—Ü—ñ—ó –ó –ö–ï–®–ï–ú

# # get_cache_key:
# # –í–∏–∑–Ω–∞—á–∞—î–º–æ, —è–∫ –±—É–¥–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ –∫–ª—é—á –∫–µ—à–∞.
# def get_cache_key(left, right):
#     """–ì–µ–Ω–µ—Ä—É—î –∫–ª—é—á –¥–ª—è –∫–µ—à–∞ –∑ –¥—ñ–∞–ø–∞–∑–æ–Ω—É (L, R). –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –∫–æ—Ä—Ç–µ–∂."""
#     return (left, right)

# # range_sum_with_cache:
# # –†–µ–∞–ª—ñ–∑—É—î –ª–æ–≥—ñ–∫—É "Cache Hit/Miss".
# def range_sum_with_cache(array, left, right):
#     """–û–±—á–∏—Å–ª—é—î —Å—É–º—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ LRUCache. O(1) –ø—Ä–∏ Cache Hit, O(R-L) –ø—Ä–∏ Cache Miss."""
#     global lru_cache
    
#     key = get_cache_key(left, right)
    
#     # 1. –°–ø—Ä–æ–±–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑ –∫–µ—à–∞. O(1)
#     cached_sum = lru_cache.get(key)
    
#     if cached_sum != -1:
#         # Cache Hit: –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –∫–µ—à–æ–≤–∞–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è
#         return cached_sum
#     else:
#         # Cache Miss: –æ–±—á–∏—Å–ª—é—î–º–æ —Å—É–º—É
#         current_sum = sum(array[left : right + 1])
        
#         # –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É –∫–µ—à –¥–ª—è –º–∞–π–±—É—Ç–Ω—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è. O(1)
#         lru_cache.put(key, current_sum)
        
#         return current_sum

# # update_with_cache:
# # –û–Ω–æ–≤–ª–µ–Ω–Ω—è –º–∞—Å–∏–≤—É —Ç–∞ —ñ–Ω–≤–∞–ª—ñ–¥–∞—Ü—ñ—è –∫–µ—à–∞.
# def update_with_cache(array, index, value):
#     """–û–Ω–æ–≤–ª—é—î –º–∞—Å–∏–≤ —ñ –≤–∏–¥–∞–ª—è—î –∑ –∫–µ—à–∞ –≤—Å—ñ –¥—ñ–∞–ø–∞–∑–æ–Ω–∏, —â–æ –º—ñ—Å—Ç—è—Ç—å –∑–º—ñ–Ω–µ–Ω–∏–π index."""
#     global lru_cache
    
#     # 1. –û–Ω–æ–≤–ª–µ–Ω–Ω—è –º–∞—Å–∏–≤—É (O(1))
#     array[index] = value
    
#     # 2. –Ü–Ω–≤–∞–ª—ñ–¥–∞—Ü—ñ—è –∫–µ—à–∞
#     keys_to_invalidate = []
#     # **–õ—ñ–Ω—ñ–π–Ω–∏–π –ø—Ä–æ—Ö—ñ–¥** –ø–æ –≤—Å—ñ—Ö –∫–ª—é—á–∞—Ö –∫–µ—à–∞ –¥–ª—è –ø–æ—à—É–∫—É –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤, —â–æ –º—ñ—Å—Ç—è—Ç—å index.
#     # –¶–µ —î–¥–∏–Ω–µ –º—ñ—Å—Ü–µ, –¥–µ –æ–ø–µ—Ä–∞—Ü—ñ—è –Ω–µ O(1) (O(K), –¥–µ K - —î–º–Ω—ñ—Å—Ç—å –∫–µ—à–∞).
#     for key in lru_cache.cache.keys():
#         left, right = key
#         # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —á–∏ –∑–º—ñ–Ω–µ–Ω–∏–π index –ø–æ—Ç—Ä–∞–ø–ª—è—î –≤ –∫–µ—à–æ–≤–∞–Ω–∏–π –¥—ñ–∞–ø–∞–∑–æ–Ω [L, R]
#         if left <= index <= right:
#             keys_to_invalidate.append(key)
            
#     # –í–∏–¥–∞–ª–µ–Ω–Ω—è —ñ–Ω–≤–∞–ª—ñ–¥–æ–≤–∞–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –∑ –∫–µ—à–∞. O(N_invalidated * 1)
#     for key in keys_to_invalidate:
#         lru_cache.invalidate_key(key)

# # ---  –ì–ï–ù–ï–†–ê–¶–Ü–Ø –¢–ê –í–ò–ö–û–ù–ê–ù–ù–Ø –ó–ê–ü–ò–¢–Ü–í ---

# # make_queries:
# # –§—É–Ω–∫—Ü—ñ—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∑–∞–ø–∏—Ç—ñ–≤ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ —Ç–µ—Ö–Ω—ñ—á–Ω–∏—Ö —É–º–æ–≤ (95% "–≥–∞—Ä—è—á–∏—Ö" Range).
# def make_queries(n, q, hot_pool=30, p_hot=0.95, p_update=0.03):
#     """–ì–µ–Ω–µ—Ä—É—î Q –∑–∞–ø–∏—Ç—ñ–≤ (Range —Ç–∞ Update) –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –ø—É–ª—É "–≥–∞—Ä—è—á–∏—Ö" –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤."""
#     random.seed(42) # –§—ñ–∫—Å—É—î–º–æ seed –¥–ª—è –≤—ñ–¥—Ç–≤–æ—Ä—é–≤–∞–Ω–æ—Å—Ç—ñ —Ç–µ—Å—Ç—ñ–≤
    
#     # –°—Ç–≤–æ—Ä—é—î–º–æ –ø—É–ª "–≥–∞—Ä—è—á–∏—Ö" –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤ [L, R]
#     hot = [(random.randint(0, n//2), random.randint(n//2, n-1)) 
#            for _ in range(hot_pool)]
    
#     queries = []
#     for _ in range(q):
#         # 3% –∑–∞–ø–∏—Ç—ñ–≤ ‚Äî Update
#         if random.random() < p_update:        
#             idx = random.randint(0, n-1)
#             val = random.randint(1, 100)
#             queries.append(("Update", idx, val))
#         # 97% –∑–∞–ø–∏—Ç—ñ–≤ ‚Äî Range
#         else:                                 
#             # 95% –∑ Range-–∑–∞–ø–∏—Ç—ñ–≤ ‚Äî –∑ "–≥–∞—Ä—è—á–æ–≥–æ" –ø—É–ª—É
#             if random.random() < p_hot:       
#                 left, right = random.choice(hot)
#             # 5% –∑ Range-–∑–∞–ø–∏—Ç—ñ–≤ ‚Äî –ø–æ–≤–Ω—ñ—Å—Ç—é –≤–∏–ø–∞–¥–∫–æ–≤—ñ
#             else:                             
#                 left = random.randint(0, n-1)
#                 right = random.randint(left, n-1)
#             queries.append(("Range", left, right))
            
#     return queries

# # –û—Å–Ω–æ–≤–Ω–∏–π –±–ª–æ–∫:
# # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤, –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç—ñ–≤ —Ç–∞ –≤–∏–≤–µ–¥–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤.
# if __name__ == "__main__":
    
#     # –¢–µ—Ö–Ω—ñ—á–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
#     N = 100_000 # –†–æ–∑–º—ñ—Ä –º–∞—Å–∏–≤—É
#     Q = 50_000  # –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤
#     K = 1000    # –Ñ–º–Ω—ñ—Å—Ç—å LRU-–∫–µ—à–∞ (CACHE_CAPACITY)
    
#     print(f"üìê –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è: N={N}, Q={Q}, K={K}")
#     print("---------------------------------------")

#     # 1. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö
#     random.seed(42) # –§—ñ–∫—Å—É—î–º–æ seed –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –º–∞—Å–∏–≤—É
#     initial_array = [random.randint(1, 100) for _ in range(N)]
#     queries = make_queries(N, Q) # –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –∑–∞–ø–∏—Ç—ñ–≤

#     # 2. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ë–ï–ó –ö–ï–®–£
    
#     # –ö–æ–ø—ñ—è –º–∞—Å–∏–≤—É, –æ—Å–∫—ñ–ª—å–∫–∏ –æ–ø–µ—Ä–∞—Ü—ñ—ó Update –∑–º—ñ–Ω—é—é—Ç—å –π–æ–≥–æ
#     array_no_cache = list(initial_array) 
    
#     start_time_no_cache = time.perf_counter()
    
#     # –í–∏–∫–æ–Ω–∞–Ω–Ω—è –≤—Å—ñ—Ö Q –∑–∞–ø–∏—Ç—ñ–≤ –±–µ–∑ –∫–µ—à—É
#     for query in queries:
#         op_type = query[0]
#         if op_type == "Range":
#             L, R = query[1], query[2]
#             _ = range_sum_no_cache(array_no_cache, L, R) 
#         elif op_type == "Update":
#             index, value = query[1], query[2]
#             update_no_cache(array_no_cache, index, value)
            
#     end_time_no_cache = time.perf_counter()
#     time_no_cache = end_time_no_cache - start_time_no_cache
    
#     # 3. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ó –ö–ï–®–ï–ú LRU
    
#     # –ö–æ–ø—ñ—è –º–∞—Å–∏–≤—É —ñ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∫–µ—à–∞
#     array_with_cache = list(initial_array) 
#     lru_cache = LRUCache(K)
    
#     start_time_with_cache = time.perf_counter()
    
#     # –í–∏–∫–æ–Ω–∞–Ω–Ω—è –≤—Å—ñ—Ö Q –∑–∞–ø–∏—Ç—ñ–≤ –∑ –∫–µ—à–µ–º
#     for query in queries:
#         op_type = query[0]
#         if op_type == "Range":
#             L, R = query[1], query[2]
#             _ = range_sum_with_cache(array_with_cache, L, R)
#         elif op_type == "Update":
#             index, value = query[1], query[2]
#             update_with_cache(array_with_cache, index, value)
            
#     end_time_with_cache = time.perf_counter()
#     time_with_cache = end_time_with_cache - start_time_with_cache
    
#     # 4. –í–∏–≤–µ–¥–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
    
#     speedup = time_no_cache / time_with_cache if time_with_cache > 0 else 0
    
#     print("\n –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è —á–∞—Å—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤")
#     # –í–∏–≤–µ–¥–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ —É –∑—Ä–æ–∑—É–º—ñ–ª–æ–º—É —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É –≤–∏–≥–ª—è–¥—ñ
#     print(f"–ë–µ–∑ –∫–µ—à—É: \t {time_no_cache:.2f} c")
#     print(f"LRU-–∫–µ—à: \t {time_with_cache:.2f} c")
#     print(f"–ü—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è: \t √ó{speedup:.1f}")
#     print("---------------------------------------")
    
#     # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –ª–æ–≥—ñ—á–Ω—É –∫–æ—Ä–µ–∫—Ç–Ω—ñ—Å—Ç—å
#     if array_no_cache != array_with_cache:
#         print("‚ùó –ü–û–ú–ò–õ–ö–ê: –§—ñ–Ω–∞–ª—å–Ω—ñ –º–∞—Å–∏–≤–∏ –Ω–µ –∑–±—ñ–≥–∞—é—Ç—å—Å—è. –õ–æ–≥—ñ—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞.")
#     else:
#         print("‚úÖ –ú–∞—Å–∏–≤–∏ –ø—ñ—Å–ª—è –æ–ø–µ—Ä–∞—Ü—ñ–π –∑–±—ñ–≥–∞—é—Ç—å—Å—è. –¢–µ—Å—Ç –∫–æ—Ä–µ–∫—Ç–Ω–∏–π.")

#–£ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ –∫—Ä–∞—â–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è, —Ü–µ –Ω–∞–∑–∏–≤–∞—é—Ç—å –ø–µ—Ä–µ—Ö–æ–¥–æ–º –≤—ñ–¥ –Ω–µ—á–∏—Å—Ç–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π 
# (–∑–∞–ª–µ–∂–Ω–∏—Ö –≤—ñ–¥ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞–Ω—É) 
# –¥–æ —á–∏—Å—Ç–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π (–∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è —á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–∏).